"use strict";exports.id=547,exports.ids=[547],exports.modules={7547:(e,t,r)=>{r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{default:()=>h});var i=r(8732),a=r(2015),l=r(9825),o=r.n(l),n=r(4337),d=r(8075),c=r(1415),u=e([n,d,c]);[n,d,c]=u.then?(await u)():u;let b=({label:e,name:t,value:r,onChange:s,type:a="text",required:l=!0,children:o,...n})=>(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsxs)("label",{htmlFor:t,className:"block text-xs font-bold uppercase tracking-widest text-gray-500 mb-2",children:[e," ",l&&(0,i.jsx)("span",{className:"text-red-500",children:"*"})]}),o||(0,i.jsx)("input",{id:t,name:t,type:a,value:r,onChange:s,className:"w-full px-0 py-3 border-b border-gray-300 focus:border-black focus:outline-none placeholder-gray-400 text-base bg-transparent",required:l,...n})]});function h({basket:e,onClose:t,onPlaceOrder:r}){let[s,l]=(0,a.useState)({state:"",city:"",zipCode:"",addressLine:""}),[o,u]=(0,a.useState)(!1),h=(0,a.useRef)(null),p=(0,a.useMemo)(()=>e.reduce((e,t)=>e+t.price*t.quantity,0),[e]),m=e=>{let{name:t,value:r}=e.target;l(e=>({...e,[t]:r}))},x=()=>{let{state:e,city:t,zipCode:r}=s;return e&&t&&r?!!/^\d+$/.test(r)||(c.toast.error("Zip code must contain only numbers"),!1):(c.toast.error("All fields are required"),!1)},f=async i=>{if(i.preventDefault(),x()&&!(p<=0)){u(!0);try{let i=d.j.currentUser;if(!i)throw Error("Authentication required");if(!i.emailVerified){c.toast.error("Please verify your email before placing an order");return}let a=await (0,n.getDoc)((0,n.doc)(d.db,"users",i.uid));if(!a.exists())throw Error("User information not found");let l={userInfo:{id:i.uid,name:a.data().firstName||"No name provided",email:i.email,phone:a.data().phone},shippingInfo:s,items:e.map(e=>({id:e.id,name:e.name,price:e.price,quantity:e.quantity,size:e.size})),totalAmount:p,createdAt:new Date().toISOString(),status:"Pending"},o=await (0,n.addDoc)((0,n.collection)(d.db,"orders"),l);r({...l,id:o.id}),c.toast.success("Order placed successfully!"),t()}catch(e){console.error("Order Error:",e),c.toast.error(e.message||"Failed to place order. Please try again.")}finally{u(!1)}}};return(0,i.jsxs)("div",{className:"fixed inset-0 bg-white backdrop-blur-sm flex justify-center items-center z-50 p-4",children:[(0,i.jsx)(c.Toaster,{position:"top-center",richColors:!0}),(0,i.jsxs)("div",{ref:h,className:"bg-white w-full max-w-6xl h-[90vh] flex flex-col lg:grid lg:grid-cols-2 shadow-xl overflow-hidden",children:[(0,i.jsxs)("div",{className:"relative h-64 lg:h-full overflow-hidden",children:[(0,i.jsx)("img",{src:"Delivery_Van.jpg",alt:"Checkout Visual",className:"object-cover w-full h-full"}),(0,i.jsx)("button",{onClick:t,className:"absolute top-4 right-4 text-white bg-black/20 hover:bg-black/30 p-2 rounded-full transition-all","aria-label":"Close checkout",disabled:o,children:(0,i.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,i.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 lg:p-8",children:[(0,i.jsx)("h2",{className:"text-3xl font-bold mb-8 tracking-tight",children:"ORDER DETAILS"}),(0,i.jsxs)("form",{onSubmit:f,className:"space-y-6",children:[(0,i.jsx)("h3",{className:"text-mx font-light italic mb-8  text-red-500",children:"*Currently, we only ship within Tunisia*"}),(0,i.jsx)(b,{label:"State",name:"state",value:s.state,onChange:m,autoComplete:"state"}),(0,i.jsx)(b,{label:"City",name:"city",value:s.city,onChange:m,autoComplete:"city"}),(0,i.jsx)(b,{label:"Zip Code",name:"zipCode",value:s.zipCode,onChange:m,type:"text",autoComplete:"postal-code"}),(0,i.jsx)(b,{label:"Address Line",name:"addressLine",value:s.addressLine,onChange:m,autoComplete:"street-address"}),(0,i.jsx)("div",{className:"pt-8 mt-8 border-t border-gray-200",children:(0,i.jsxs)("p",{className:"text-2xl font-bold text-right",children:["Total: ",p.toFixed(2)," TND"]})}),(0,i.jsxs)("div",{className:"flex justify-end space-x-4 mt-8",children:[(0,i.jsx)("button",{type:"button",onClick:t,className:"w-full py-4 border-2 border-black font-bold uppercase tracking-wide flex items-center justify-center transition-all bg-white text-black hover:bg-black hover:text-white focus:bg-white focus:text-black focus:outline-none ",disabled:o,children:"Cancel"}),(0,i.jsx)("button",{type:"submit",className:"w-full py-4 border-2 border-black font-bold uppercase tracking-wide flex items-center justify-center transition-all bg-black text-white hover:bg-white hover:text-black focus:bg-white focus:text-black focus:outline-none",disabled:o,children:o?(0,i.jsx)("div",{className:"loading"}):"Confirm Order"})]})]})]})]})]})}b.propTypes={label:o().string.isRequired,name:o().string.isRequired,value:o().string.isRequired,onChange:o().func.isRequired,type:o().string,required:o().bool,children:o().node},h.propTypes={basket:o().arrayOf(o().shape({id:o().string.isRequired,name:o().string.isRequired,price:o().number.isRequired,quantity:o().number.isRequired})).isRequired,onClose:o().func.isRequired,onPlaceOrder:o().func.isRequired},s()}catch(e){s(e)}})}};